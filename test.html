<!DOCTYPE html>
<html>
<head>
    <title>Supabase Example</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
        button {
            margin: 5px;
            padding: 10px 15px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background: #45a049;
        }
        .user-item {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .banana-btn {
            background: #FFD700;
            color: black;
        }
        .banana-btn:hover {
            background: #FFC400;
        }
    </style>
</head>
<body>

    <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –±–∞–Ω–∞–Ω–∞–º–∏</h2>
    
    <button onclick="addUser()">–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
    <button onclick="getUsers()">–ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
    
    <div id="usersList"></div>
    <div id="result" style="margin-top: 20px; padding: 10px; background: #f0f0f0; border-radius: 5px;"></div>

    <script>
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Supabase
        const supabaseUrl = 'https://gdfkvpufqnkwwdtvavbh.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdkZmt2cHVmcW5rd3dkdHZhdmJoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTczOTk0NDQsImV4cCI6MjA3Mjk3NTQ0NH0.ME2hehhEiy1tqwVCh9Xcu01ACKPp6IjecXExr4JXkR4';
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        // –§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ë–ï–ó boolean –ø–æ–ª–µ–π)
        async function addUser() {
            const names = ['–ò–≤–∞–Ω', '–ú–∞—Ä–∏—è', '–ü–µ—Ç—Ä', '–ê–Ω–Ω–∞', '–°–µ—Ä–≥–µ–π'];
            const randomName = names[Math.floor(Math.random() * names.length)];
            
            // –í—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ –ø–æ–ª—è, –∫–æ—Ç–æ—Ä—ã–µ —Ç–æ—á–Ω–æ –µ—Å—Ç—å –≤ —Ç–∞–±–ª–∏—Ü–µ
            const userData = { 
                name: randomName + ' ' + '–ë–∞–Ω–∞–Ω–æ–≤', 
                email: randomName.toLowerCase() + '@banana.ru',
                bananas: Math.floor(Math.random() * 10)
            };
            
            const { data, error } = await supabase
                .from('users')
                .insert([userData]);
            
            if (error) {
                showResult('–û—à–∏–±–∫–∞: ' + error.message);
                console.error('–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:', error);
            } else {
                showResult('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω —Å –±–∞–Ω–∞–Ω–∞–º–∏!');
                getUsers();
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        async function getUsers() {
            const { data, error } = await supabase
                .from('users')
                .select('*')
                .order('bananas', { ascending: false });
            
            if (error) {
                showResult('–û—à–∏–±–∫–∞: ' + error.message);
            } else {
                displayUsers(data);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¢–û–õ–¨–ö–û –±–∞–Ω–∞–Ω–æ–≤
        async function updateBananas(userId, currentBananas) {
            const newBananas = currentBananas + 1;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø–æ–ª–µ bananas
            const { data, error } = await supabase
                .from('users')
                .update({ bananas: newBananas })
                .eq('id', userId);
            
            if (error) {
                showResult('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ' + error.message);
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:', error);
            } else {
                showResult('üçå +1 –±–∞–Ω–∞–Ω! –¢–µ–ø–µ—Ä—å: ' + newBananas);
                getUsers();
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function displayUsers(users) {
            const usersList = document.getElementById('usersList');
            
            if (!users || users.length === 0) {
                usersList.innerHTML = '<p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ—Ç</p>';
                return;
            }
            
            usersList.innerHTML = '<h3>–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</h3>';
            
            users.forEach(user => {
                const userDiv = document.createElement('div');
                userDiv.className = 'user-item';
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è
                userDiv.innerHTML = `
                    <strong>${user.name || '–ë–µ–∑ –∏–º–µ–Ω–∏'}</strong> 
                    <br>Email: ${user.email || '–ù–µ—Ç email'}
                    <br>–ë–∞–Ω–∞–Ω—ã: ${user.bananas !== undefined ? user.bananas : 0} üçå
                    <br>ID: ${user.id ? user.id.substring(0, 8) + '...' : '–ù–µ—Ç ID'}
                    <br>
                    <button class="banana-btn" onclick="updateBananas('${user.id}', ${user.bananas !== undefined ? user.bananas : 0})">
                        –î–æ–±–∞–≤–∏—Ç—å –±–∞–Ω–∞–Ω
                    </button>
                `;
                usersList.appendChild(userDiv);
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
        function showResult(message) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = message;
            setTimeout(() => {
                resultDiv.innerHTML = '';
            }, 3000);
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        getUsers();

    </script>

</body>
</html>